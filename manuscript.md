# Operon Conservation Analysis Methods

## Genome Annotation

Prior to homology searches, all bacterial genome assemblies were annotated using Prokka version 1.14.6 to ensure consistent gene prediction and annotation across the dataset. We processed 8,587 *Enterococcus faecalis* genome assemblies obtained from public databases, with each genome annotated using species-specific parameters (--kingdom Bacteria --genus Enterococcus --species faecalis).

Prokka annotation quality was consistent across the dataset, with genomes averaging 2,821 predicted genes (median 2,800, range 2,391-3,728, SD 201). This narrow distribution with no significant outliers confirmed the high quality of the input assemblies and annotation process.

## Reference Operon Sequence Extraction

Reference sequences for homology searches were extracted from a curated GenBank file (8,082 bp) containing the complete fructoselysine/glucoselysine utilization operon from *Enterococcus faecalis*.

The operon consists of seven protein-coding genes arranged in the following order: *frpC* (fructoselysine-6-phosphate deglycase), *glpC* (glucoselysine-6-phosphate deglycase), *ptsD* (PTS system IID component), *ptsC* (PTS system IIC component), *ptsB* (PTS system IIB component), *ptsA* (PTS system IIA component), and *fruR* (sigma-54 dependent transcriptional regulator). Additionally, two regulatory elements were identified: the operon promoter region and the Pribnow box (-10 consensus sequence).

Sequence extraction was performed using BioPython to parse the GenBank format and extract both nucleotide and amino acid sequences. All genes in this operon are encoded on the complement strand and were appropriately reverse-complemented during extraction. The extraction process generated multiple query sequence sets: 7 protein sequences (average length 352 amino acids, range 154-919 residues, total 2,461 residues), 7 nucleotide gene sequences (average length 1,058 bp, range 465-2,760 bp, total 7,404 bp), and 2 regulatory nucleotide sequences for non-coding elements (average length 289 bp, total 578 bp).

These reference sequences were formatted as FASTA files with standardized headers containing locus tags, gene names, and functional annotations. The resulting query sets provided comprehensive coverage of both coding and regulatory elements necessary for identifying complete operon homologs across diverse bacterial genomes in subsequent BLAST searches.

## BLAST-based Homology Search

We employed a multi-strategy BLAST search approach to comprehensively identify operon homologs across bacterial genomes. Reference sequences for the seven-gene operon (*frpC*, *glpC*, *ptsD*, *ptsC*, *ptsB*, *ptsA*, *fruR*) were extracted from the *Enterococcus faecalis* V583 genome and used as queries in complementary search strategies.

The reference query set comprised 7 protein sequences (averaging 352 amino acids, range 154-919 aa, total 2,461 aa) and 9 nucleotide sequences including 7 coding sequences (averaging 1,058 bp, range 465-2,760 bp, total 7,404 bp) plus 2 non-coding regulatory elements (promoter region of 570 bp and Pribnow box of 8 bp). BLAST searches were performed against 8,587 *E. faecalis* genomes using NCBI BLAST+ with an E-value threshold of 1×10⁻⁵.

For protein-based searches, we used tblastn to align the 7 reference protein sequences against genomic assemblies. This approach enabled detection of homologous genes regardless of annotation quality, identifying coding sequences through six-frame translation. To capture nucleotide-level conservation patterns, we performed complementary blastn searches using the corresponding nucleotide sequences as queries against the same genomic targets, including searches for non-coding regulatory elements.

Across all search strategies, we generated 375,406 BLAST hits from 8,587 genomes searched. The distribution of hits reflected differential conservation among operon components: PTS system genes generated the most hits (*ptsB*: 93,679; *ptsD*: 91,344; *ptsC*: 85,101), followed by regulatory and metabolic genes (*fruR*: 42,808; *ptsA*: 28,165; *glpC*: 17,351), with the deglycase *frpC* generating 8,306 hits. The promoter region searches yielded 8,652 blastn hits.

Of the total hits, 66,458 (17.7%) met high-quality criteria (≥90% sequence identity and ≥80% query coverage). The mean sequence identity across all hits was 44.7% (median 33.1%) with mean query coverage of 94.6% (median 97.0%), indicating broad detection capability with varying degrees of conservation. Notably, 41,655 hits achieved E-values of 0.0, indicating extremely significant matches, while all hits met the E-value threshold of <1×10⁻⁵.

High-quality hits demonstrated exceptional operon prevalence across the dataset: *frpC* was detected in 8,261 genomes, *glpC* in 8,260, *ptsD* in 8,261, *ptsC* in 8,257, *ptsB* in 8,260, *ptsA* in 8,260, and *fruR* in 8,254 genomes. Complete operons containing all seven genes with high-quality matches were identified in 8,250 genomes (96.1% of the dataset), demonstrating near-universal presence of the intact operon in *E. faecalis*.

For each genome and query gene combination, we retained only the highest-scoring hit based on bitscore (mean 236.7, maximum 1,886) to avoid redundancy. Both DNA strands were searched automatically by BLAST, with reverse complement matches identified by coordinate order (sstart > send). This comprehensive search strategy ensured robust detection of operon components while capturing the sequence variation necessary for downstream conservation and phylogenetic analyses.

Multiple sequence alignments were generated using MAFFT version 7.490 with automatic algorithm selection, and temporary files were directed to high-performance local storage (/vol/tmp) to optimize computational efficiency during large-scale alignment operations.

## Core Gene Analysis

To establish a baseline for evaluating operon gene conservation, we performed comprehensive core gene analysis across all annotated *E. faecalis* genomes. Core genes were defined as those present in ≥95% of genomes, representing the conserved genetic backbone of the species.

Core gene identification was performed by parsing Prokka-generated GFF annotation files across the 8,587 genome dataset. This analysis identified 5,564 unique genes, with 1,252 genes meeting the ≥95% prevalence threshold for core gene designation. Of these, 225 genes were present in 100% of genomes, and 1,078 genes achieved ≥99% presence, representing the most universally conserved genetic elements.

For each core gene, nucleotide sequences were extracted from Prokka annotations across all genomes where present, yielding an average of 8,543 sequences per gene. The extracted sequences averaged 960 bp in length (range 171-2,340 bp). Multiple sequence alignments were generated for all 1,252 core genes using MAFFT version 7.490 with automatic algorithm selection. The resulting alignments averaged 1,170 bp in length with 8,543 sequences per alignment.

Conservation analysis using Shannon entropy-based scoring (0=highly variable, 1=perfectly conserved) revealed high overall conservation with a mean score of 0.931 (SD 0.107). Among all core genes analyzed, 85.5% of positions were highly conserved (score ≥0.9), 10.9% were moderately conserved (0.7-0.9), and 3.6% showed lower conservation. The most conserved genes included essential ribosomal proteins (*rpsK* and *secE* with near-perfect conservation), while genes with lower conservation included metabolic and regulatory genes with more variable functions (*dgaR_3* at 0.628, *dppE_8* at 0.533).

This core gene analysis established the baseline conservation patterns for essential *E. faecalis* genes, providing the reference framework for comparing the conservation of fructoselysine/glucoselysine operon genes.

## Operon Sequence Extraction and Multiple Sequence Alignment

Following the comprehensive BLAST-based homology searches described above, we implemented a sequence extraction pipeline to retrieve actual operon gene sequences from genomic assemblies using the pre-computed BLAST coordinates. This approach leveraged the existing search results to extract high-quality sequences for phylogenetic and conservation analyses without re-running computationally expensive BLAST operations.

Sequence extraction was performed using a coordinate-based mapping system that translated BLAST hit positions from 25,761 BLAST result files to genomic coordinates in both Prokka-annotated genomes and raw assemblies. The pipeline processed 2,090 BLAST hits with quality filtering applied using stringent thresholds of ≥90% sequence identity and ≥80% query coverage to ensure high-quality homologs while capturing meaningful sequence diversity. This resulted in 336 high-quality sequences being extracted (16.1% extraction rate), with a mean sequence identity of 43.5% across all hits and mean query coverage of 94.4%. The extraction pipeline automatically handled strand orientation, performing reverse complementation for genes identified on the negative strand (indicated by sstart > send coordinates in BLAST output).

Four complementary extraction strategies were employed to comprehensively evaluate the impact of different data sources and search approaches on downstream analyses. Strategy A employed tblastn (protein-to-nucleotide) mapping against Prokka-annotated genome files, providing high-confidence gene identification through amino acid sequence homology while benefiting from consistent gene boundary definitions. Strategy B used blastn (nucleotide-to-nucleotide) searches against the same Prokka genome files to capture nucleotide-level conservation patterns with precise gene annotations. Strategy C extracted sequence variants from Prokka-predicted coding sequences using blastn against a reference database, recovering query sequence fragments that reflect actual sequence diversity in target genomes. Strategy D employed tblastn mapping directly against raw genomic assemblies, bypassing annotation-dependent gene boundaries to capture authentic genomic sequences as they exist in the original assemblies.

While Strategy A (Prokka-based tblastn) was utilized for gene boundary analysis and validation due to its reliance on consistent annotation frameworks, Strategy D (assembly-based tblastn) was selected as the primary approach for downstream phylogenetic and evolutionary analyses. This choice was motivated by several critical advantages: (1) direct extraction from source assemblies eliminates potential annotation artifacts that could bias evolutionary inference, (2) tblastn searches maintain sensitivity to detect homologs even in the presence of minor sequencing errors or frameshifts common in draft assemblies, (3) extracted sequences represent the actual genomic DNA that underwent evolutionary processes rather than computationally predicted gene models, and (4) this approach provides the most authentic sequence data for calculating evolutionary parameters such as dN/dS ratios and phylogenetic relationships.

The extraction pipeline successfully retrieved sequences for all seven operon genes, yielding an average of 8,259 sequences per gene (median 8,260), with average sequence lengths of 1,053 bp (range 87-2,769 bp). This comprehensive extraction provided near-complete coverage of the operon across the genome dataset, with each of the seven operon genes (*frpC*, *glpC*, *ptsD*, *ptsC*, *ptsB*, *ptsA*, *fruR*) represented in over 96% of genomes containing the operon.

Multiple sequence alignments were generated for all extracted sequences using MAFFT version 7.490 with automatic algorithm selection optimized for each sequence type and size. The alignment pipeline created 8 separate MSAs (7 for coding genes and 1 for non-coding regulatory regions), with coding gene alignments maintaining reading frame integrity for subsequent evolutionary analyses. The resulting alignments averaged 998 positions in length and contained an average of 8,300 sequences per alignment.

Conservation analysis was performed on the resulting alignments using Shannon entropy-based scoring to quantify positional conservation across sequences. For each position in the alignment, Shannon entropy was calculated as H = -Σ(pi × log2(pi)), where pi represents the frequency of nucleotide i (A, C, G, T) at that position, excluding gaps and ambiguous bases. The entropy values were normalized to conservation scores using the formula: Conservation = 1 - (H/Hmax), where Hmax = 2.0 bits represents the maximum possible entropy for DNA sequences. This normalization produces scores ranging from 0 (highly variable) to 1 (perfectly conserved).

In addition to positional conservation, we calculated two complementary metrics for each alignment: (1) Gap percentage, quantifying the proportion of gap characters across all positions and sequences to assess alignment quality and sequence completeness; and (2) Mean pairwise identity, computed using an efficient count-based algorithm that avoids explicit pairwise comparisons. For each position in the alignment, we counted the frequency of each nucleotide (A, C, G, T) and calculated the number of identical pairs as Σ(ci × (ci-1)/2) for each nucleotide count ci, divided by the total number of possible pairs (n × (n-1)/2) where n is the number of sequences at that position. This approach reduces computational complexity from O(n² × L) to O(n × L) for n sequences of length L, enabling rapid analysis of large alignments while producing mathematically identical results to exhaustive pairwise comparison.

The mean conservation score across all positions provided a single metric for comparing genes, while position-specific scores enabled identification of functionally critical regions within operon genes. This comprehensive conservation analysis provided the foundation for comparing operon gene conservation against the established core gene baseline. Visualization outputs included 5 gene-specific conservation plots (*ptsB*, *ptsA*, *ptsD*, *ptsC*, *glpC*) displaying Shannon entropy-based position-wise conservation scores with visual indicators for regions of high and low conservation.

## Comparative Conservation Analysis

To contextualize the conservation patterns of the fructoselysine/glucoselysine operon genes, we performed comprehensive comparative analysis against the established core gene baseline. All seven operon genes demonstrated remarkably high conservation levels (99.38-99.90%), positioning them among the most conserved genes in the *E. faecalis* genome despite not meeting the strict core gene prevalence threshold of ≥95% genome presence.

Ranking analysis revealed that operon genes occupied positions within the top 27.8% of all core genes for conservation, with individual genes achieving the following rankings among 1,251 core genes: *ptsB* (rank 53, 95.9th percentile), *ptsA* (rank 81, 93.8th percentile), *ptsC* (rank 114, 91.2th percentile), *fruR* (rank 192, 85.1st percentile), *ptsD* (rank 200, 84.5th percentile), *glpC* (rank 307, 76.1st percentile), and *frpC* (rank 348, 72.9th percentile). The PTS system components (*ptsA*, *ptsB*, *ptsC*, *ptsD*) exhibited particularly high conservation (99.54-99.90%), consistent with their essential role in substrate transport and phosphorylation.

The high conservation of operon genes, comparable to essential housekeeping genes, suggests strong purifying selection maintaining sequence integrity despite the operon's absence from some genomes. This pattern indicates that when present, the operon functions as a critical metabolic module that tolerates minimal sequence variation, likely due to the requirement for precise protein-protein interactions within the PTS transport complex and the enzymatic specificity needed for fructoselysine and glucoselysine metabolism. The conservation levels exceed those of many core genes involved in variable cellular processes, underscoring the functional importance of this operon in bacterial adaptation to protein glycation products commonly encountered in host environments.

## Operon Synteny and Gene Order Analysis

Analysis of gene order and synteny across 8,587 *E. faecalis* genomes revealed extraordinary structural conservation of the fructoselysine/glucoselysine operon. The operon displays an "all-or-nothing" distribution: 8,260 genomes (96.2%) contain all seven genes complete, while 326 genomes (3.8%) lack the operon entirely, with only a single genome showing a partial operon (4 genes). Among the 8,260 genomes with complete operons, 99.8% (8,241) preserve the exact canonical gene order (*frpC* → *glpC* → *ptsD* → *ptsC* → *ptsB* → *ptsA* → *fruR*), with 99.8% maintaining all genes on the same strand and 99.6% (8,223) on the same contig.

The operon forms an exceptionally compact genetic unit with a mean inter-gene distance of only 19 bp (median 13 bp, range 1-53,894 bp), indicating tight transcriptional coupling. Remarkably, no inversions or rearrangements were detected in any genome. The 19 genomes (0.2%) with non-canonical gene orders all have genes distributed across multiple contigs (fragmented assemblies), suggesting these represent assembly artifacts rather than true biological rearrangements, as functional gene groups remain clustered (e.g., PTS components *ptsB*-*ptsC*-*ptsD* stay together).

This exceptional conservation pattern (8,223 genomes (95.8%)) show complete and perfectly conserved operons—demonstrates that the operon functions as an indivisible genetic module. Any disruption to gene order, orientation, or spacing appears to be strongly selected against, consistent with the requirement for coordinated expression and precise stoichiometry of operon components for efficient metabolism of protein glycation products.

## Start Codon Usage and Translation Initiation

Analysis of 58,030 operon gene instances across 8,261 genomes revealed distinct start codon preferences within the operon. The vast majority of genes use ATG as the start codon (87.3%), with TTG accounting for 12.7% and GTG being essentially absent (0.03%). Remarkably, *ptsA* stands out as the only gene that predominantly uses TTG as its primary start codon (87.3% TTG, 12.7% ATG), while all other six operon genes almost exclusively use ATG (99-100%).

A striking finding emerged from metadata stratification analysis: laboratory-adapted strains show dramatically altered *ptsA* start codon usage compared to environmental and clinical isolates. Laboratory strains use ATG in 55.1% of cases (n=325) versus only 10.9% in other niches (n=7,925), representing a 44.2 percentage point increase. This difference is highly statistically significant (Fisher's exact test p = 4.4×10⁻⁷⁹, odds ratio = 10.0), indicating laboratory strains are 10-fold more likely to use ATG instead of the canonical TTG. This adaptation pattern suggests that laboratory cultivation conditions may select for altered translational regulation of the PTS IIA component.

Additionally, 86.9% of all operon genes possess potential upstream alternative start sites, with 72.3% of all genes having upstream starts associated with ribosome binding sites (RBS). The mean distance to these upstream starts is 30 nucleotides (median 24 nt, max 111 nt). Interestingly, while most genes show near-universal presence of alternative starts (97-100%), *ptsA* shows the lowest frequency (13%), consistent with its unique TTG usage pattern. The high prevalence of alternative upstream starts with RBS motifs suggests either widespread translational flexibility or systematic annotation challenges in identifying true translation initiation sites.

## Figures

### Figure 1: Conservation Ranking of Operon Genes
**File:** 06_diversity_analysis/output/conservation_ranking_bars.pdf

Comparative conservation analysis of fructoselysine/glucoselysine operon genes relative to 1,251 core genes in *Enterococcus faecalis*. The bar chart displays the conservation ranking of each operon gene within the core gene distribution, with genes ordered by their conservation scores. All seven operon genes (highlighted in distinct colors) rank within the top 27.8% of core genes for sequence conservation, with PTS system components (*ptsB*, *ptsA*, *ptsC*, *ptsD*) occupying positions in the top 200 most conserved genes. Conservation scores are calculated based on Shannon entropy across multiple sequence alignments, with values ranging from 0 (highly variable) to 1 (perfectly conserved). The exceptionally high conservation of operon genes (99.38-99.90%) despite their non-core status suggests strong purifying selection maintaining functional integrity when the operon is present. Gray bars represent the distribution of all 1,251 core genes, providing context for the relative conservation levels of the operon components.
